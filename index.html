<html>
<head>
    <title>Assignment 04</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
</head>

<body>
    <header>
        Traversing XML & JSON document by AJAX call
    </header>
    <h2>Using Github server</h2>
    <main>
        <div id="parent">
            <div id="laptopList">
                <h2>Laptops</h2>
                <article>
                    This site gives you a variety of laptopLists to choose from.<br>
                    It uses a XML list from the server to retrieve the laptopList objects.<br>
                    You can get a list of all the laptopLists available in the inventory.<br>
                    All you have to do is press the Get Laptop button to view them.<br>
                </article>
                <button id="btnLaptop" onclick="DownloadXML()">Get Laptops</button>
                <div id="laptopListResult">
                    <table id="tableLaptop" border="1px solid blue">
                        <tr>
                            <th>Laptop Info</th>
                        </tr>
                    </table>
                </div>
            </div>
            <div id="gpu">
                <h2>GPU</h2>
                <article>
                    This site gives you a variety of graphic cards to choose from.<br>
                    It uses a JSON list from the server to retrieve the JSON objects.<br>
                    You can get a list of all the GPUs available in the inventory.<br>
                    All you have to do is press the Get GPU button to view them.<br>
                </article>
                <button id="btnGPU" onclick="DownloadJSON()">Get GPU</button>
                <div id="gpuResult">
                    <table id="tableGPU" border="1px solid blue">
                        <tr>
                            <th>ID</th>
                            <th>Brand</th>
                            <th>Model</th>
                            <th>VRAM</th>
                            <th>Price</th>
                            <th>Fans</th>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </main>
    <script type="text/javascript">
        //FUNCTION TO DOWNLOAD XML DOC AND TRAVERSE IT
        function DownloadXML() {
            //CREATE NEW XHTTP REQUEST
            var xhttp = new XMLHttpRequest();

            //SET REQUEST TYPE
            xhttp.responseType = "text/xml";

            //ON STATE CHANGE HANDLER
            xhttp.onreadystatechange = function() {
                if(xhttp.readyState == 4 && xhttp.status == 200) {
                    var xmlDoc = xhttp.responseXML;
                    var output = "";

                    for(i = 0; i < xmlDoc.getElementsByTagName("laptops")[0].childNodes.length; i++) {
                        output += "<tr>";
                            output += "<td>" + xmlDoc.getElementsByTagName("laptops")[0].childNodes[i].textContent + "</td>";
                        output += "</tr>";
                    }
                    document.getElementById('tableLaptop').innerHTML += output;
                }
            };
            xhttp.open("GET", "laptops.xml");
            xhttp.send();
        }

        function DownloadJSON() {
            //CREATE A NEW XHTTP REQUEST
            var xhttp = new XMLHttpRequest();

            //SET REQUEST TYPE
            xhttp.timeout = 3000;
            xhttp.responseType = "json";

            //ON STATE CHANGE HANDLER
            xhttp.onreadystatechange = function() {
                if(xhttp.readyState == 4 && xhttp.status == 200) {
                    var jsonFile = xhttp.response;
                    var output = "";
                    for(i = 0; i < jsonFile.graphicCards.length; i++) {
                        output += "<tr>";
                        output += "<td>" + jsonFile.graphicCards[i].id + "</td>";
                        output += "<td>" + jsonFile.graphicCards[i].brand + "</td>";
                        output += "<td>" + jsonFile.graphicCards[i].model + "</td>";
                        output += "<td>" + jsonFile.graphicCards[i].vram + "</td>";
                        output += "<td>" + jsonFile.graphicCards[i].price + "</td>";
                        output += "<td>" + jsonFile.graphicCards[i].fans + "</td>";
                        output += "</tr>";
                    }
                    document.getElementById('tableGPU').innerHTML += output;
                }
            };
            xhttp.open("GET", "gpu.json");
            xhttp.send();
        }
    </script>
</body>
</html>
